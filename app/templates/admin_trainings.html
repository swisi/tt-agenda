{% extends "base.html" %}

{% block content %}
<div class="page-header mb-4">
    <h1 class="page-title">
        <i class="bi bi-calendar-check me-2"></i>Trainings verwalten
    </h1>
    <div class="page-actions">
        <a href="{{ url_for('main.index') }}" class="btn btn-secondary">
            <i class="bi bi-arrow-left me-1"></i>Zurück zur Übersicht
        </a>
        <div class="btn-group">
            <a href="{{ url_for('admin.new_training') }}" class="btn btn-primary">
                <i class="bi bi-plus-circle me-1"></i>Template
            </a>
            <a href="{{ url_for('admin.new_hidden_training') }}" class="btn btn-outline-primary">
                <i class="bi bi-plus-circle me-1"></i>Einmalig
            </a>
        </div>
    </div>
</div>

<form class="row g-2 align-items-center mb-3" 
      hx-get="{{ url_for('admin.trainings_partial') }}" 
      hx-target="#trainings-list" 
      hx-swap="innerHTML" 
      hx-push-url="false">
    <div class="col-sm-8 col-md-6 col-lg-4">
        <input type="search" name="q" value="{{ request.args.get('q', '') }}" class="form-control" placeholder="Suche nach Name…">
    </div>
    <div class="col-auto">
        <select name="type" class="form-select" onchange="this.form.requestSubmit()">
            <option value="all" {% if request.args.get('type', 'all') == 'all' %}selected{% endif %}>Alle anzeigen</option>
            <option value="template" {% if request.args.get('type') == 'template' %}selected{% endif %}>Templates</option>
            <option value="hidden" {% if request.args.get('type') == 'hidden' %}selected{% endif %}>Einmalig</option>
            <option value="instance" {% if request.args.get('type') == 'instance' %}selected{% endif %}>Angepasst</option>
        </select>
    </div>
    <div class="col-auto">
        <button type="submit" class="btn btn-outline-primary">
            <i class="bi bi-search me-1"></i>Filtern
        </button>
        <a href="{{ url_for('admin.admin_trainings') }}" class="btn btn-outline-secondary ms-1">Zurücksetzen</a>
    </div>
</form>

{% if (trainings|length + hidden_trainings|length + instances|length) == 0 %}
<div class="text-center py-5">
    <i class="bi bi-inbox empty-state-icon"></i>
    <h3 class="mt-3 text-muted">Keine Trainings vorhanden</h3>
    <p class="text-muted">Erstellen Sie Ihr erstes Training</p>
    <a href="{{ url_for('admin.new_training') }}" class="btn btn-primary">
        <i class="bi bi-plus-circle me-1"></i>Neues Training
    </a>
</div>
{% else %}
<div id="trainings-list">
    {% include 'includes/all_trainings_table.html' %}
</div>

<div class="alert alert-info mt-4">
    <h5><i class="bi bi-info-circle me-2"></i>Legende</h5>
    <ul class="mb-0">
        <li><span class="badge bg-primary">Template</span> - Wiederkehrende Trainings nach Wochentag</li>
        <li><span class="badge bg-warning text-dark">Einmalig</span> - Einmalige Trainings an einem bestimmten Datum</li>
        <li><span class="badge bg-info">Angepasst</span> - Individuelle Anpassungen von Template-Trainings</li>
    </ul>
</div>
{% endif %}

{% block scripts %}
<script>
    // Tooltips initialisieren
    var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
    var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new bootstrap.Tooltip(tooltipTriggerEl)
    })
</script>
{% endblock %}
{% endblock %}
