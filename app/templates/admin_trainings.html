{% extends "base.html" %}

{% block content %}
<div class="page-header">
    <h1 class="page-title">
        <i class="bi bi-gear-fill me-2"></i>Trainings Verwaltung
    </h1>
    <div class="page-actions">
        <a href="{{ url_for('main.index') }}" class="btn btn-secondary">
            <i class="bi bi-arrow-left me-1"></i>Zurück zur Übersicht
        </a>
        <a href="{{ url_for('admin.new_training') }}" class="btn btn-primary">
            <i class="bi bi-plus-circle me-1"></i>Neues Training
        </a>
    </div>
</div>

{% if trainings|length == 0 %}
<div class="text-center py-5">
    <i class="bi bi-inbox" style="font-size: 4rem; color: #cbd5e1;"></i>
    <h3 class="mt-3 text-muted">Keine Trainings vorhanden</h3>
    <p class="text-muted">Erstellen Sie Ihr erstes Training</p>
    <a href="{{ url_for('admin.new_training') }}" class="btn btn-primary">
        <i class="bi bi-plus-circle me-1"></i>Neues Training
    </a>
</div>
{% else %}
<div class="table-responsive">
    <table class="table table-hover">
        <thead class="table-dark">
            <tr>
                <th>Name</th>
                <th>Wochentag</th>
                <th>Zeitraum</th>
                <th>Startzeit</th>
                <th>Aktivitäten</th>
                <th class="text-end">Aktionen</th>
            </tr>
        </thead>
        <tbody>
            {% for training in trainings %}
            <tr>
                <td>
                    <strong>{{ training.name }}</strong>
                </td>
                <td>
                    <span class="badge bg-primary">{{ weekdays[training.weekday] }}</span>
                </td>
                <td>
                    <small>{{ training.start_date.strftime('%d.%m.%Y') }} - {{ training.end_date.strftime('%d.%m.%Y') }}</small>
                </td>
                <td>
                    <i class="bi bi-clock me-1"></i>{{ training.start_time.strftime('%H:%M') }}
                </td>
                <td>
                    <span class="badge bg-info">{{ training.activities|length }} Aktivitäten</span>
                </td>
                <td>
                    <div class="d-flex justify-content-end gap-1">
                        <a href="{{ url_for('main.training_schedule', id=training.id) }}" 
                           class="btn btn-sm btn-outline-success" 
                           title="Zeitplan anzeigen"
                           data-bs-toggle="tooltip">
                            <i class="bi bi-calendar3"></i>
                        </a>
                        <a href="{{ url_for('admin.edit_training', id=training.id) }}" 
                           class="btn btn-sm btn-outline-primary" 
                           title="Bearbeiten"
                           data-bs-toggle="tooltip">
                            <i class="bi bi-pencil-fill"></i>
                        </a>
                        <form method="POST" 
                              action="{{ url_for('admin.copy_training', id=training.id) }}" 
                              onsubmit="return confirm('Training &quot;{{ training.name }}&quot; wirklich kopieren?');">
                            <button type="submit" 
                                    class="btn btn-sm btn-outline-secondary" 
                                    title="Kopieren"
                                    data-bs-toggle="tooltip">
                                <i class="bi bi-files"></i>
                            </button>
                        </form>
                        <form method="POST" 
                              action="{{ url_for('admin.delete_training', id=training.id) }}" 
                              onsubmit="return confirm('Training &quot;{{ training.name }}&quot; wirklich löschen? Alle Aktivitäten werden ebenfalls gelöscht!');">
                            <button type="submit" 
                                    class="btn btn-sm btn-outline-danger" 
                                    title="Löschen"
                                    data-bs-toggle="tooltip">
                                <i class="bi bi-trash-fill"></i>
                            </button>
                        </form>
                    </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<div class="alert alert-info mt-4">
    <h5><i class="bi bi-info-circle me-2"></i>Hinweise</h5>
    <ul class="mb-0">
        <li><strong>Zeitplan:</strong> Zeigt den vollständigen Trainingsplan an</li>
        <li><strong>Bearbeiten:</strong> Ändert Trainingsdetails und Aktivitäten</li>
        <li><strong>Kopieren:</strong> Erstellt eine vollständige Kopie des Trainings mit allen Aktivitäten</li>
        <li><strong>Löschen:</strong> Entfernt das Training und alle zugehörigen Aktivitäten permanent</li>
    </ul>
</div>
{% endif %}

<style>
    .table-hover tbody tr {
        cursor: default;
    }
    
    .table-hover tbody tr:hover {
        background-color: rgba(0, 0, 0, 0.02);
    }
    
    [data-theme="dark"] .table-hover tbody tr:hover {
        background-color: rgba(255, 255, 255, 0.05);
    }
    
    .btn-group-sm .btn {
        padding: 0.25rem 0.5rem;
    }
</style>
{% block scripts %}
<script>
    // Tooltips initialisieren
    var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
    var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new bootstrap.Tooltip(tooltipTriggerEl)
    })
</script>
{% endblock %}
{% endblock %}
