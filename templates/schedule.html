{% extends "base.html" %}

{% block content %}
<h1>Zeitplan: {{ training.name }}</h1>
<a href="{{ url_for('edit_training', id=training.id) }}" class="btn btn-secondary mb-3">Zur√ºck</a>

<div class="table-responsive">
    <table class="table table-bordered schedule-table">
        <thead class="table-dark">
            <tr>
                <th>From</th>
                <th>To</th>
                <th>min</th>
                <th>Activity</th>
                <th>OL</th>
                <th>DL</th>
                <th>LB</th>
                <th>RB</th>
                <th>DB</th>
                <th>WR/TE</th>
                <th>QB</th>
            </tr>
        </thead>
        <tbody>
            {% set activities = training.activities|sort(attribute='order_index') %}
            {% for activity in activities %}
            {% set start_datetime = activity.start_time %}
            {% set end_time_minutes = (activity.start_time.hour * 60 + activity.start_time.minute + activity.duration) %}
            {% set end_hour = (end_time_minutes // 60) %}
            {% set end_min = (end_time_minutes % 60) %}
            
            <tr class="{% if loop.index % 2 == 0 %}table-row-even{% else %}table-row-odd{% endif %}">
                <td>{{ activity.start_time.strftime('%H:%M') }}</td>
                <td>{{ '%02d:%02d'|format(end_hour, end_min) }}</td>
                <td>{{ activity.duration }}</td>
                <td><strong>{{ activity.activity_type|title }}</strong></td>
                
                {% set cells = activity|build_group_cells %}
                {% for cell in cells %}
                <td class="{{ cell.class }}" {% if cell.colspan > 1 %}colspan="{{ cell.colspan }}"{% endif %}>{{ cell.content }}</td>
                {% endfor %}
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<style>
.schedule-table {
    border: 2px solid #333;
    border-collapse: collapse;
}

.schedule-table td, .schedule-table th {
    vertical-align: middle;
    text-align: center;
    border: 1px solid #999;
    padding: 8px;
}

.schedule-table td:nth-child(4) {
    text-align: left;
}

.schedule-table tbody tr.table-row-odd td {
    background-color: #e3f2fd;
}

.schedule-table tbody tr.table-row-even td {
    background-color: #b8ddf7;
}

.schedule-table tbody tr.table-row-odd td.table-success {
    background-color: #a5d6a7 !important;
}

.schedule-table tbody tr.table-row-even td.table-success {
    background-color: #81c784 !important;
}

.schedule-table thead th {
    border: 2px solid #333;
}
</style>
{% endblock %}
